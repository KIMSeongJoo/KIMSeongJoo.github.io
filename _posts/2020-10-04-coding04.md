---
title: 코딩을 지탱하는 기술(4)
date: 2020-10-04
categories: coding
---

# 구조화 프로그래밍의 탄생
1960년대 후반, 사람이 프로그램을 보다 편하게 쓰고 읽을 수 있도록 규칙을 만들자 는 흐름을 타고 구조화 프로그래밍이 태어났다.
현재 우리가 자주 사용하고 있는 if 문이나, while 문 등의 규칙(구문)을 도입하여 코드 구조를 쉽게 만들자는 생각이다.

이 구문들은 코드 구조를 알기 쉽게 하기 위해 도입되었다. 하지만 지금에 와서는 있는 것이 너무 당연 하게 여겨질 정도여서 무엇이 편해졌는지 잘 모를 수 있다.

## if 가 탄생하기 전
#### if 는 왜 있는 걸까?
어셈블리어에는 if 문이 없다. 그러나 어셈블리어는 C 언어에서 간단히 변환된다. 그래서 if문을 사용한 코드를 C 언어로 쓰고, 그것을 어셈블리어로 컴파일 하도록 한다.  
```c
int main() {
    int x = 123;
    /* if 문 앞 */
    if ( x = 456 ) {
        /* if 문 안 */
    } 
    /* if 문 뒤 */
} 
```
이를 컴파일 하면 아래와 같은 어셈블리어 코드가 출력된다.
```C
_main:
    .....
    mov1        $123, -8(%rbp)
    #if 문 앞
    mov1        -8(%rbp), %eax
    cmp1        $456, %eax
    jne         LBB1_2
    #if 문 안
LBB1_2:
    #if 문 뒤
    ... 
```

1. `-8(%rbp)`는 원래 코드의 x 라고 해석한다. x에 수치 123을 대입한다.
2. x/의 값을 %eax라는 임시 저장 소에 이동 후 수치 456과 비교한다.
3. `jne` 는바로 직전 비교에서 양쪽이 동일하지 않으면 LBB1_2로 점프 하라는 명령어이다. 역이로 말하면 양쪽이 동일하면 점프하지 말고 다음 명령이 실행횐다 와 일맥상통하다.
4. if문 안쪽 코드로 양쪽이 동일할 때만 실행된다. 동일하지 않다면 LBB1_2로 점프하지 않는다.

이와 같이 조건을 만족하면 점프 라는 명령은 꽤 초기부터 존재했다. 예를 들어 11949년 EDSAC은 특정 메로리가 0 이상이면 점프, 특정 메모리가 마이너스면 점프 등의 명령 들을 가지고 있었다.

#### if-else는 왜 있는 걸까?
if 문을 배울때 분명 else 나 else-if 등과 함께 배우는데, else 나 else-if 가 없는 어셈블리어의 경우 어떤식으로 프로그램을 짤 수 있을까??

#### 어셈블리어의 표현 방법
우선은 else를 사용하는 코드를 C 언어로 구현해보고 그것을 어셈블리어로 컴파일 해본다.  
아래의 예제는 x 값이 0보다 큰 경우, 작은 경우, 같은 경우에 따라서 처리를 나누는 예시이다.

```C
/* if 앞 */
if(x > 0){
    /* 양수의 경우 */
} else if (x < 0) {
    /* 음수의 경우 */
} else {
    /* 0일 경우 */
}
/* if 뒤 */
```

이것을 앞서 한 것과 마찬가지로 컴파일 한 것이 아래의 코드이다.

```C
_main:
    ...
    #if 앞
    mov1    -8(%rbp), $eax
    cmp1    $0, $eax
    jle     LBB1_2
    #양수의 경우
    jmp2    LBB1_5
LBB1_2
    mov1    -8(%rbp), $eax
    cmp1    $0, $eax
    jge     LBB1_4
    # 음수의 경우
    jmp LBB1_5
LBB1_4
    # 0일 경우
LBB1_5
    # if뒤
```

이 코드 자체는 만약 xx 일 경우 OO을 해라 라고 표현하고 싶지만, 만약 OO 이 아니면 어디로 점프해, 그리고 XX를 해 라고 뒤집어 표현해야 하기 때문에 혼란 스러울 수 있다.

#### C 언어의 표현 방법
c 언어에서는 else를 사용하지 않고 코드를 쓸 수 없을까?  
c 언어 에서도 지정한 행으로 점프하기 위한 명령을 사용하면 가능하다. goto END; 는 END: 라고 쓰여진 행으로 점프하는 의미이다.
```c
void not_use_if(int x){
    if(x <= 0) goto NOT_POSITIVE;
    printf ("양수일 경우")
    goto END;
   NOT_POSITIVE:
    if( x >= 0 ) goeo NOT_NEGATIVE;
    printf("음수일 경우")
    goto END;
   NOT_NEGATIVE:
    printf("제로")
   END:
    return;
}
```

##### if-else 사용의 장점
C 언어로 프로그래밍을 할 때 else를 사용할 필요가 없음을 알았다. 대신 goto가 사용되고 있지만, goto기능은 지정한 행으로 점프 라는 매우 알기 쉬운 구조이다.  

그럼 앞에 있는 코드가 알기 쉬운 코드일까? 필자에게네 생각보다 복잡한 내용이고, 정열이 잘 되어 있지 않아 천천히 읽지 않으면 이해하는데 시간이 걸리는 코드로 보인다.  
이어서 if-else를 사용한 코드와 비교해보자

```C
void use_if(int x) {
    if(x > 0) {
        printf("양수일 경우") 
    } else if (x < 0 ) {
        printf("음수일 경우")
    } else {
        printf("제로")
    }
}
```

if-else 구문을 도입했을 때의 이점이 바로 여기에 있다. 조건이 참인 경우 와 거짓인 경우의 처리 흐름을 분배한다 는 패턴은 프로그래밍에 빈번히 사용된다.
이것을 간단하고 읽기 쉬운 형태로 쓰기위하여 if-else 구문이 새롭게 도입된 것이다.  

프로그래밍을 하면서 else가 반드시 필요한 건 아니다. 하지만 필자는 else를 사용하는 것이 훨씬 편하고, 다른이들 또한 else를 사용했으면 좋겠다.  
그게 코드를 더 편하게 읽을 수 있기 때문이다.

goto 는 강력하고 이해하기 쉬운 개념이다. 그러나 너무 원시적이다.
아무 생각없이 goto 를 남용하면 프로글챔이 엉망진창이 되어버린다. 말에 고삐를 채우듯이, goto에도 어느 정도 제한을 두는 것이 코드를 이해하기 쉽다고 생각한다.
if-else나, while, break는 제한이 붙은 goto라 생각하면 될 것 같다.

## for, 수치를 증가시키는 while을 읽기 쉽게 표현
#### for를 사용하는 방법
아래의 코드는 i을 0이상 N 미만의 범위에서 1씩 증가시키며 표시하는 코드이다.

```C
for(i = 0; i < N; i++ ) {
    printf("%d\n", i);
}
```

#### for를 사용하지 않는 방법
동일한 내용을 while 문을 사용해서 표현하면 아래와 같다.

```C
i = 0
while( i < N ) {
    printf("%d\n", i);
}
```

0이상 N 미만의 수에 대해 어떤 처리를 한다 는 구문은 자주 사용된다. 예를 들어 배열 xs의 내용물 전부에 대해 어떤 처리를 하고 싶다.  
xs[0]에서 xs[n-1]까지 각 요소에 대해 처리하고 싶다 는 의미다. 그러나 while 문을 사용해서 이것을 쓰면 루프 밖에서 i = 0 루프 조건식에서 i < N 루프 마지막에 i++ 라고 3곳으로 코드가 분산되어 버린다.
이로 인해 나중에 코드를 읽을 때 그 의도를 파악하기 어렵다. for 문을 사용하면 한 곳에 모두 정리가 되기 때문에 루프의 의도를 쉽게 이해할 수 있다.  
```C
for (i = 0; i < N; i++ ) {
    printf("%d\n", i);
}
```

이와 같이 시작값, 증가값, 종료값 3가지를 함께 표현하는 for 문은 1958년에 만들어진 ALGOL 58에서 이미 발명된 것이다.
```bash
for I : = 0 ( 1 ) N; ...
```

#### foreach 처리 대상으로 반복 제어
for 문이 다시 한 번 진화한 것이 현재 많은 언어에서 사용하고 있는 foreach 문이다. Java 에서는 확장 for 문 이라고 불리고 있지만. Perl, PHP, C#등 많은 언어에서 foreach라는 이름으로 불리고 있다.

while은 조건식을로 반복을 제어한다. for문은 횟수로 반복을 제어한다.  
foreach 구문은 처리 대상으로 반복을 제어한다.  

foreach가 없는 C 언어에서 배열의 각 요소에 대한 어떤 처리를 실행하는 목적으로 for가 자주 사용된다.  
foreach 구문은 어떤 대상의 요소 전부에 어떤 처리를 한다는 코드를 쉽게 쓰기 위해 만들어졌다.

```java
// 배열
int[] items = new int[]{1, 2, 3, 4, 5}

// 일반 for 문으로 각 요소를 출력
for (int i = 0; i < items.length; i++ ) {
    int item = items[i];
    Sy stem.out.Println(item);
}

// 확장 for문으로 각 요소를 출력
for(int item; items) {
    System.out.Println(item);
}
```

for 문에서는 0이상 items 크기 마만의 범위에서 i를 1씩 증가시키면 서 items의 i번째를 표시 라고 표현하고 있지만, foreach 구문을 사용하면 items의 각 요소를 표시 라고 간단하고 쓰고 있다.

## 정리
이번엔 if, while, for 문 등의 처리 흘므을 제어하기 위한 규칙에 대해 살펴보았다. 굳이 이 구문들을 사용하지 않아도 프로그램을 짤 수는 있지만,
사용하는 것이 보다 알기 쉬운 코드를 구성할 수 있다는 것을 안내하는 시간이라 할 수 있다.
이렇게 구비되어 있는 구문을 잘 사용하는것이 좋다.
